
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Locate P, Q, S and T waves in ECG &#8212; NeuroKit2 0.2.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ECG-Derived Respiration (EDR)" href="../ecg_edr/ecg_edr.html" />
    <link rel="prev" title="Extract and Visualize Individual Heartbeats" href="../ecg_heartbeats/ecg_heartbeats.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/neurokit.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Menu
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../introduction.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../authors.html">
   Authors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cite_us.html">
   Cite us
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_eventrelated/bio_eventrelated.html">
     Event-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_intervalrelated/bio_intervalrelated.html">
     Interval-related Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bio_custom/bio_custom.html">
     Customize your Processing Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_hrv/ecg_hrv.html">
     Heart Rate Varability (HRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_heartbeats/ecg_heartbeats.html">
     Extract and Visualize Individual Heartbeats
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Locate P, Q, S and T waves in ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_edr/ecg_edr.html">
     ECG-Derived Respiration (EDR)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ecg_generate_12leads/ecg_generate_12leads.html">
     Generating Abnormal 12-leads ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eda_peaks/eda_peaks.html">
     Analyze Electrodermal Activity (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../rsp_rrv/rsp_rrv.html">
     Respiratory Rate Variability (RRV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eog_analyze/eog_analyze.html">
     Analyze Electrooculography (EOG)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../signal_simulation/signal_simulation.html">
     Simulate Artificial Physiological Signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg_power/eeg_power.html">
     EEG Power in Frequency Bands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../misc_fit_function/misc_fit_function.html">
     Fit a function to a non-linear pattern
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../misc_epochs_create/misc_epochs_create.html">
     Create epochs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../functions/index.html">
   Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/bio.html">
     Bio
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/ecg.html">
     ECG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/ppg.html">
     PPG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/hrv.html">
     HRV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/rsp.html">
     RSP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eda.html">
     EDA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/emg.html">
     EMG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eog.html">
     EOG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/eeg.html">
     EEG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/microstates.html">
     Microstates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/signal.html">
     Signal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/events.html">
     Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/epochs.html">
     Epochs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/data.html">
     Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/complexity.html">
     Complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/markov.html">
     Markov Chains
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/stats.html">
     Stats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/misc.html">
     Misc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../functions/benchmark.html">
     Benchmarking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../resources/index.html">
   Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/learn_python.html">
     Learn Python in 10 minutes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/contributing.html">
     Contributing guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/recording.html">
     Recording good quality signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../resources/resources.html">
     Additional Resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../studies/index.html">
   Studies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.mdpi.com/1424-8220/21/12/3998">
     HRV Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/mwa6x/">
     HRV Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://psyarxiv.com/f8k3x/">
     Complexity Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/complexity_benchmark.html">
     Complexity Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/ecg_benchmark.html">
     ECG Benchmark
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/erp_gam.html">
     EEG Analysis with GAMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../studies/eog_blinktemplate.html">
     EOG blink template
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/neuropsychology/NeuroKit">
   Repository
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/issues/new?title=Issue%20on%20page%20%2Fexamples/ecg_delineate/ecg_delineate.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/neuropsychology/NeuroKit/edit/dev/docs/examples/ecg_delineate/ecg_delineate.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/examples/ecg_delineate/ecg_delineate.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-the-r-peaks">
   Find the R peaks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#locate-other-waves-p-q-s-t-and-their-onset-and-offset">
   Locate other waves (P, Q, S, T) and their onset and offset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peak-method">
     Peak method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuous-wavelet-method-cwt">
     Continuous Wavelet Method (CWT)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discrete-wavelet-method-dwt-default-method">
     Discrete Wavelet Method (DWT) - default method
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Locate P, Q, S and T waves in ECG</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#find-the-r-peaks">
   Find the R peaks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#locate-other-waves-p-q-s-t-and-their-onset-and-offset">
   Locate other waves (P, Q, S, T) and their onset and offset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peak-method">
     Peak method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuous-wavelet-method-cwt">
     Continuous Wavelet Method (CWT)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discrete-wavelet-method-dwt-default-method">
     Discrete Wavelet Method (DWT) - default method
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="locate-p-q-s-and-t-waves-in-ecg">
<h1>Locate P, Q, S and T waves in ECG<a class="headerlink" href="#locate-p-q-s-and-t-waves-in-ecg" title="Permalink to this headline">#</a></h1>
<p>This example can be referenced by <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/cite_us.html">citing the package</a>.</p>
<p>This example shows how to use NeuroKit to delineate the ECG peaks in Python using NeuroKit. This means detecting and locating all components of the QRS complex, including <strong>P-peaks</strong> and <strong>T-peaks</strong>, as well their <strong>onsets</strong> and <strong>offsets</strong> from an ECG signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load NeuroKit and other useful packages</span>
<span class="kn">import</span> <span class="nn">neurokit2</span> <span class="k">as</span> <span class="nn">nk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This &quot;decorative&quot; cell should be hidden from the docs once this is implemented:</span>
<span class="c1"># https://github.com/microsoft/vscode-jupyter/issues/1182 </span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>  <span class="c1"># Bigger images</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">14</span>
</pre></div>
</div>
</div>
</div>
<p>In this example, we will use a short segment of ECG signal with sampling rate of 3000 Hz.</p>
<section id="find-the-r-peaks">
<h2>Find the R peaks<a class="headerlink" href="#find-the-r-peaks" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve ECG data from data folder</span>
<span class="n">ecg_signal</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;ecg_1000hz&quot;</span><span class="p">)</span>
<span class="c1"># Extract R-peaks locations</span>
<span class="n">_</span><span class="p">,</span> <span class="n">rpeaks</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_peaks</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-peaks">ecg_peaks()</a> function will return a dictionary contains the samples at which R-peaks are located.</p>
<p>Let’s visualize the R-peaks location in the signal to make sure it got detected correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize R-peaks in ECG signal</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">(</span><span class="n">rpeaks</span><span class="p">[</span><span class="s1">&#39;ECG_R_Peaks&#39;</span><span class="p">],</span> <span class="n">ecg_signal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1f194c50d05c78da6e037e06a6af08ef57a2662897182a04c9b066813de848cf.png" src="../../_images/1f194c50d05c78da6e037e06a6af08ef57a2662897182a04c9b066813de848cf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zooming into the first 5 R-peaks</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">(</span><span class="n">rpeaks</span><span class="p">[</span><span class="s1">&#39;ECG_R_Peaks&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">],</span> <span class="n">ecg_signal</span><span class="p">[:</span><span class="mi">6000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9e6392da3fc749328ade0bb8828d80ef5054a2258a03d5a71807729c33a85ef6.png" src="../../_images/9e6392da3fc749328ade0bb8828d80ef5054a2258a03d5a71807729c33a85ef6.png" />
</div>
</div>
<p>Visually, the R-peaks seem to have been correctly identified. You can also explore searching for R-peaks using different methods provided by NeuroKit <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-peaks">ecg_peaks()</a>.</p>
</section>
<section id="locate-other-waves-p-q-s-t-and-their-onset-and-offset">
<h2>Locate other waves (P, Q, S, T) and their onset and offset<a class="headerlink" href="#locate-other-waves-p-q-s-t-and-their-onset-and-offset" title="Permalink to this headline">#</a></h2>
<p>In <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-delineate">ecg_delineate()</a>, NeuroKit implements different methods to segment the QRS complexes. There are the derivative method and the other methods that make use of Wavelet to delineate the complexes.</p>
<section id="peak-method">
<h3>Peak method<a class="headerlink" href="#peak-method" title="Permalink to this headline">#</a></h3>
<p>First, let’s take a look at the ‘peak’ method and its output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal</span>
<span class="n">_</span><span class="p">,</span> <span class="n">waves_peak</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> <span class="n">rpeaks</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;peak&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zooming into the first 3 R-peaks, with focus on T_peaks, P-peaks, Q-peaks and S-peaks</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">events_plot</span><span class="p">([</span><span class="n">waves_peak</span><span class="p">[</span><span class="s1">&#39;ECG_T_Peaks&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">],</span> 
                       <span class="n">waves_peak</span><span class="p">[</span><span class="s1">&#39;ECG_P_Peaks&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">],</span>
                       <span class="n">waves_peak</span><span class="p">[</span><span class="s1">&#39;ECG_Q_Peaks&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">],</span>
                       <span class="n">waves_peak</span><span class="p">[</span><span class="s1">&#39;ECG_S_Peaks&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">ecg_signal</span><span class="p">[:</span><span class="mi">4000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/56fe8d51156d9776e5e601777ab840b3f6d14c3b620c741ef7ee38f2a362bbb9.png" src="../../_images/56fe8d51156d9776e5e601777ab840b3f6d14c3b620c741ef7ee38f2a362bbb9.png" />
</div>
</div>
<p>Visually, the ‘peak’ method seems to have correctly identified the P-peaks, Q-peaks, S-peaks and T-peaks for this signal, at least, for the first few complexes. Well done, <em>peak</em>!</p>
<p>However, it can be quite tiring to be zooming in to each complex and inspect them one by one. To have a better overview of all complexes at once, you can make use of the <code class="docutils literal notranslate"><span class="pre">show</span></code> argument in <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-delineate">ecg_delineate()</a> as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal and visualizing all peaks of ECG complexes</span>
<span class="n">_</span><span class="p">,</span> <span class="n">waves_peak</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                 <span class="n">rpeaks</span><span class="p">,</span> 
                                 <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                 <span class="n">method</span><span class="o">=</span><span class="s2">&quot;peak&quot;</span><span class="p">,</span> 
                                 <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3f7b2cda0de49d1e05175eb1f766df340080b2e8c65daa90ddf0f5236e9cbadb.png" src="../../_images/3f7b2cda0de49d1e05175eb1f766df340080b2e8c65daa90ddf0f5236e9cbadb.png" />
</div>
</div>
<p>The ‘peak’ method is doing a glamorous job with identifying all the ECG peaks for this piece of ECG signal.</p>
<p>On top of the above peaks, the peak method also identify the wave boundaries, namely the onset of P-peaks and offset of T-peaks. You can vary the argument <code class="docutils literal notranslate"><span class="pre">show_type</span></code> to specify the information you would like plot.</p>
<p>Let’s visualize them below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal and visualizing all P-peaks boundaries</span>
<span class="n">signal_peak</span><span class="p">,</span> <span class="n">waves_peak</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                           <span class="n">rpeaks</span><span class="p">,</span> 
                                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                           <span class="n">method</span><span class="o">=</span><span class="s2">&quot;peak&quot;</span><span class="p">,</span> 
                                           <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                           <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d59d13bc1ee971a31e4afa72e230c52c2380d15baacb0e457fd099c9c4519e27.png" src="../../_images/d59d13bc1ee971a31e4afa72e230c52c2380d15baacb0e457fd099c9c4519e27.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal and visualizing all T-peaks boundaries</span>
<span class="n">signal_peaj</span><span class="p">,</span> <span class="n">waves_peak</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                           <span class="n">rpeaks</span><span class="p">,</span> 
                                           <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                           <span class="n">method</span><span class="o">=</span><span class="s2">&quot;peak&quot;</span><span class="p">,</span> 
                                           <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                           <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8b539578b4abf3a852c7bb71426620b858c08c15df2df57ffbd079c9dd924e14.png" src="../../_images/8b539578b4abf3a852c7bb71426620b858c08c15df2df57ffbd079c9dd924e14.png" />
</div>
</div>
<p>Both the onsets of P-peaks and the offsets of T-peaks appears to have been correctly identified here. This information will be used to delineate cardiac phases in <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-phase">ecg_phase()</a>.</p>
<p>Let’s next take a look at the continuous wavelet method.</p>
</section>
<section id="continuous-wavelet-method-cwt">
<h3>Continuous Wavelet Method (CWT)<a class="headerlink" href="#continuous-wavelet-method-cwt" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal</span>
<span class="n">signal_cwt</span><span class="p">,</span> <span class="n">waves_cwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c3c36577686a2f62594b0e7330418edfd9bcb7d113ba770583639d8e901f4e22.png" src="../../_images/c3c36577686a2f62594b0e7330418edfd9bcb7d113ba770583639d8e901f4e22.png" />
</div>
</div>
<p>By specifying <em>‘all’</em> in the <code class="docutils literal notranslate"><span class="pre">show_type</span></code> argument, you can plot all delineated information output by the cwt method. However, it could be hard to evaluate the accuracy of the delineated information with everyhing plotted together. Let’s tease them apart!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize P-peaks and T-peaks</span>
<span class="n">signal_cwt</span><span class="p">,</span> <span class="n">waves_cwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e9c6d8616ccaeb4ae76641aed9d239f65d65243c248bb38c5af2d9e85ab60cd1.png" src="../../_images/e9c6d8616ccaeb4ae76641aed9d239f65d65243c248bb38c5af2d9e85ab60cd1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize T-waves boundaries</span>
<span class="n">signal_cwt</span><span class="p">,</span> <span class="n">waves_cwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ee702160a82390936a025370aa214923ece7753953b7191aedc3e6419f77259a.png" src="../../_images/ee702160a82390936a025370aa214923ece7753953b7191aedc3e6419f77259a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize P-waves boundaries</span>
<span class="n">signal_cwt</span><span class="p">,</span> <span class="n">waves_cwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/da001d86ed4931ba7d2c1500f6032349a54e94c9d14723c771806963b0202cee.png" src="../../_images/da001d86ed4931ba7d2c1500f6032349a54e94c9d14723c771806963b0202cee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize R-waves boundaries</span>
<span class="n">signal_cwt</span><span class="p">,</span> <span class="n">waves_cwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a28d4063ec231c4e3370506f0dc68809b5535eaea8714d6d6cbcf8fbbbde9769.png" src="../../_images/a28d4063ec231c4e3370506f0dc68809b5535eaea8714d6d6cbcf8fbbbde9769.png" />
</div>
</div>
<p><em>Unlike the peak method, the continuous wavelet method does not idenfity the Q-peaks and S-peaks. However, it provides more information regarding the boundaries of the waves</em></p>
<p>Visually, except a few exception, CWT method is doing a great job. However, the P-waves boundaries are not very clearly identified here.</p>
<p>Last but not least, we will look at the third method in NeuroKit <a class="reference external" href="https://neuropsychology.github.io/NeuroKit/functions/ecg.html#ecg-delineate">ecg_delineate()</a> function: the discrete wavelet method.</p>
</section>
<section id="discrete-wavelet-method-dwt-default-method">
<h3>Discrete Wavelet Method (DWT) - default method<a class="headerlink" href="#discrete-wavelet-method-dwt-default-method" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delineate the ECG signal</span>
<span class="n">signal_dwt</span><span class="p">,</span> <span class="n">waves_dwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../../_images/4ed878f0b378f797245f917451cac648b0fc29ec7030c5db5687ed3042fbea4f.png" src="../../_images/4ed878f0b378f797245f917451cac648b0fc29ec7030c5db5687ed3042fbea4f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize P-peaks and T-peaks</span>
<span class="n">signal_dwt</span><span class="p">,</span> <span class="n">waves_dwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../../_images/c37fc12623ca79e1bc7e4c8dd48d8678345275ae9c27e76ea0f18ca76b5aa528.png" src="../../_images/c37fc12623ca79e1bc7e4c8dd48d8678345275ae9c27e76ea0f18ca76b5aa528.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualize T-wave boundaries</span>
<span class="n">signal_dwt</span><span class="p">,</span> <span class="n">waves_dwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../../_images/e14b6cd6e5664856d799f696d241b7048223c34dcd30cd7e2d852183c83dea67.png" src="../../_images/e14b6cd6e5664856d799f696d241b7048223c34dcd30cd7e2d852183c83dea67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize P-wave boundaries</span>
<span class="n">signal_dwt</span><span class="p">,</span> <span class="n">waves_dwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_P&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../../_images/618e1294ca5762b9e0802b47cb074efac8ec7c004dda0ffe3b4170f1a73d138c.png" src="../../_images/618e1294ca5762b9e0802b47cb074efac8ec7c004dda0ffe3b4170f1a73d138c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize R-wave boundaries</span>
<span class="n">signal_dwt</span><span class="p">,</span> <span class="n">waves_dwt</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">ecg_delineate</span><span class="p">(</span><span class="n">ecg_signal</span><span class="p">,</span> 
                                         <span class="n">rpeaks</span><span class="p">,</span> 
                                         <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> 
                                         <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dwt&quot;</span><span class="p">,</span> 
                                         <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                         <span class="n">show_type</span><span class="o">=</span><span class="s1">&#39;bounds_R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../../_images/317173d34f309ecb905dccc1148d358c09f74f028a570d4a5055b7bd6722d95e.png" src="../../_images/317173d34f309ecb905dccc1148d358c09f74f028a570d4a5055b7bd6722d95e.png" />
</div>
</div>
<p>Visually, from the plots above, the delineated outputs of DWT appear to be more accurate than CWT, especially for the P-peaks and P-wave boundaries.</p>
<p>Overall, for this signal, the peak and DWT methods seem to be superior to the CWT.</p>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../ecg_heartbeats/ecg_heartbeats.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Extract and Visualize Individual Heartbeats</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../ecg_edr/ecg_edr.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ECG-Derived Respiration (EDR)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a> and the <a href="https://github.com/neuropsychology/NeuroKit/blob/master/AUTHORS.rst">Team</a><br/>
  
      &copy; Copyright 2020–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>